<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Compte - Speech2Health</title>
    <link rel="stylesheet" href="/css/s2h-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Intégration du Header -->
    <header class="s2h-header">
      <div class="s2h-container s2h-header__content">
        <!-- Logo (lien vers l'accueil) -->
        <a href="/" class="s2h-logo">
          <div class="s2h-logo__icon">
            <img src="/assets/images/logo-s2h.png" alt="Logo Speech2Health" class="s2h-logo__image">
          </div>
          <span class="s2h-logo__text">Speech2Health</span>
        </a>
        
        <!-- Navigation principale -->
        <nav class="s2h-nav">
          <ul class="s2h-nav__list">
            <li class="s2h-nav__item"><a href="/pages/explorer/" class="s2h-nav__link">Explorer</a></li>
            <li class="s2h-nav__item"><a href="/pages/creer-un-test/" class="s2h-nav__link">Créer un test</a></li>
            <li class="s2h-nav__item"><a href="/pages/evaluer-et-contribuer/" class="s2h-nav__link">Évaluer & Contribuer</a></li>
            <li class="s2h-nav__item"><a href="/pages/communaute/" class="s2h-nav__link">Communauté</a></li>
            <li class="s2h-nav__item"><a href="/pages/mon-compte/" class="s2h-nav__link s2h-nav__link--active">Mon compte</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="s2h-main s2h-container s2h-my-lg">
        <div class="s2h-grid">
            <!-- Colonne de gauche : Profil et menu -->
            <div class="s2h-grid__col--3 s2h-grid__col--md-12">
                <div class="s2h-card s2h-mb-md">
                    <div class="s2h-flex s2h-items-center s2h-flex-col s2h-text-center s2h-mb">
                        <div class="s2h-user__avatar s2h-mb-sm" style="width: 80px; height: 80px; font-size: 2em;">
                            CL
                        </div>
                        <h2 class="s2h-font-lg">Claire Lemaire</h2>
                        <p class="s2h-text-medium">Chercheur en neurosciences</p>
                        <span class="s2h-badge s2h-badge--primary s2h-mt-xs">Membre Premium</span>
                    </div>
                    <div class="s2h-card__footer">
                        <a href="/pages/mon-compte/profil.html" class="s2h-btn s2h-btn--outline s2h-w-full">Modifier mon profil</a>
                    </div>
                </div>

                <!-- Menu de navigation du compte -->
                <div class="s2h-card">
                    <nav class="s2h-account-nav">
                        <ul class="s2h-account-nav__list">
                            <li class="s2h-account-nav__item s2h-account-nav__item--active">
                                <a href="/pages/mon-compte/index.html" class="s2h-account-nav__link">
                                    <i class="fas fa-home s2h-mr-sm"></i> Tableau de bord
                                </a>
                            </li>
                            <li class="s2h-account-nav__item">
                                <a href="/pages/mon-compte/tests.html" class="s2h-account-nav__link">
                                    <i class="fas fa-flask s2h-mr-sm"></i> Mes tests
                                </a>
                            </li>
                            <li class="s2h-account-nav__item">
                                <a href="/pages/mon-compte/resultats.html" class="s2h-account-nav__link">
                                    <i class="fas fa-chart-bar s2h-mr-sm"></i> Mes résultats
                                </a>
                            </li>
                            <li class="s2h-account-nav__item">
                                <a href="/pages/mon-compte/parametres.html" class="s2h-account-nav__link">
                                    <i class="fas fa-cog s2h-mr-sm"></i> Paramètres
                                </a>
                            </li>
                            <li class="s2h-account-nav__item">
                                <a href="#" class="s2h-account-nav__link s2h-text-danger">
                                    <i class="fas fa-sign-out-alt s2h-mr-sm"></i> Déconnexion
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>

            <!-- Colonne principale : Contenu du tableau de bord -->
            <div class="s2h-grid__col--9 s2h-grid__col--md-12">
                <h1 class="s2h-font-xl s2h-mb-lg">Tableau de bord</h1>

                <!-- Statistiques et indicateurs -->
                <div class="s2h-stats s2h-mb-lg">
                    <div class="s2h-stats__item s2h-card s2h-p-md">
                        <div class="s2h-stats__number">8</div>
                        <div class="s2h-stats__label">Tests créés</div>
                    </div>
                    <div class="s2h-stats__item s2h-card s2h-p-md">
                        <div class="s2h-stats__number">34</div>
                        <div class="s2h-stats__label">Tests passés</div>
                    </div>
                    <div class="s2h-stats__item s2h-card s2h-p-md">
                        <div class="s2h-stats__number">12</div>
                        <div class="s2h-stats__label">Contributions</div>
                    </div>
                    <div class="s2h-stats__item s2h-card s2h-p-md">
                        <div class="s2h-stats__number">142</div>
                        <div class="s2h-stats__label">Points d'impact</div>
                    </div>
                </div>

                <!-- Intégration VAPI Speech Assistant -->
                <div class="s2h-card s2h-card--primary s2h-mb-lg">
                    <div class="s2h-card__header">
                        <h2 class="s2h-card__title">Assistant Vocal Speech2Health</h2>
                        <p class="s2h-card__subtitle">Posez vos questions à notre assistant vocal intelligent</p>
                    </div>
                    <div class="s2h-card__body s2h-p-md">
                        <p class="s2h-mb-md">Notre assistant vocal est là pour vous aider ! Posez des questions sur:</p>
                        <ul class="s2h-mb-lg">
                            <li class="s2h-mb-xs">Les fonctionnalités de la plateforme Speech2Health</li>
                            <li class="s2h-mb-xs">La création et l'analyse de tests cognitifs</li>
                            <li class="s2h-mb-xs">Les données et résultats de vos tests</li>
                            <li class="s2h-mb-xs">Les tendances et recommandations personnalisées</li>
                        </ul>
                        <div class="s2h-flex s2h-justify-center">
                            <button id="vapi-trigger-custom" class="s2h-btn s2h-btn--accent s2h-btn--lg s2h-btn--pill">
                                <i class="fas fa-microphone s2h-mr-sm"></i> Activer l'assistant vocal
                            </button>
                        </div>
                        <!-- Message de statut pour l'assistant vocal -->
                        <div id="vapi-status" class="s2h-text-center s2h-mt-md s2h-text-medium" style="display: none;">
                            Initialisation de l'assistant vocal...
                        </div>
                    </div>
                </div>

                <!-- Tests récents -->
                <div class="s2h-mb-lg">
                    <div class="s2h-flex s2h-justify-between s2h-items-center s2h-mb-md">
                        <h2 class="s2h-font-lg">Vos tests récents</h2>
                        <a href="/pages/mon-compte/tests.html" class="s2h-btn s2h-btn--sm s2h-btn--outline">Voir tous</a>
                    </div>
                    <div class="s2h-card-grid">
                        <!-- Test 1 -->
                        <div class="s2h-card">
                            <div class="s2h-card__header">
                                <h3 class="s2h-card__title">Test d'analyse vocale</h3>
                                <div class="s2h-flex s2h-flex-gap-xs">
                                    <span class="s2h-badge s2h-badge--language">Langage</span>
                                    <span class="s2h-badge s2h-badge--validated">Validé</span>
                                </div>
                            </div>
                            <div class="s2h-card__body">
                                <p class="s2h-mb-sm">Évaluation des marqueurs vocaux pour la détection précoce de troubles cognitifs.</p>
                                <div class="s2h-score">
                                    <span>Impact: </span>
                                    <div class="s2h-score__indicator">
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="s2h-card__footer">
                                <a href="/pages/explorer/detail-test.html" class="s2h-btn s2h-btn--sm s2h-btn--outline">Voir détails</a>
                            </div>
                        </div>
                        
                        <!-- Test 2 -->
                        <div class="s2h-card">
                            <div class="s2h-card__header">
                                <h3 class="s2h-card__title">Évaluation narrative</h3>
                                <div class="s2h-flex s2h-flex-gap-xs">
                                    <span class="s2h-badge s2h-badge--memory">Mémoire</span>
                                    <span class="s2h-badge s2h-badge--testing">En test</span>
                                </div>
                            </div>
                            <div class="s2h-card__body">
                                <p class="s2h-mb-sm">Test de mémoire épisodique basé sur la narration et les capacités de rappel.</p>
                                <div class="s2h-score">
                                    <span>Impact: </span>
                                    <div class="s2h-score__indicator">
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot s2h-score__dot--filled"></div>
                                        <div class="s2h-score__dot"></div>
                                        <div class="s2h-score__dot"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="s2h-card__footer">
                                <a href="/pages/explorer/detail-test.html" class="s2h-btn s2h-btn--sm s2h-btn--outline">Voir détails</a>
                            </div>
                        </div>
                        
                        <!-- Nouveau test -->
                        <div class="s2h-card s2h-card--dashed">
                            <div class="s2h-flex s2h-flex-col s2h-items-center s2h-justify-center s2h-h-full s2h-text-center s2h-p-md">
                                <div class="s2h-mb-md">
                                    <i class="fas fa-plus-circle s2h-font-xxl s2h-text-primary"></i>
                                </div>
                                <h3 class="s2h-mb-sm">Créer un nouveau test</h3>
                                <p class="s2h-text-medium s2h-mb-md">Concevez facilement un nouveau test ou protocole d'évaluation</p>
                                <a href="/pages/creer-un-test/" class="s2h-btn s2h-btn--primary s2h-btn--sm">Commencer</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activité récente -->
                <div class="s2h-mb-lg">
                    <h2 class="s2h-font-lg s2h-mb-md">Activité récente</h2>
                    <div class="s2h-timeline">
                        <div class="s2h-timeline__line"></div>
                        <div class="s2h-timeline__events">
                            <!-- Événement 1 -->
                            <div class="s2h-timeline__event">
                                <div class="s2h-timeline__dot"></div>
                                <div class="s2h-timeline__content">
                                    <div class="s2h-timeline__date">Aujourd'hui - 10:45</div>
                                    <div class="s2h-timeline__title">Test validé</div>
                                    <div class="s2h-timeline__description">Votre test "Analyse des marqueurs prosodiques" a été validé par le comité scientifique.</div>
                                </div>
                            </div>
                            
                            <!-- Événement 2 -->
                            <div class="s2h-timeline__event s2h-timeline--improvement">
                                <div class="s2h-timeline__dot"></div>
                                <div class="s2h-timeline__content">
                                    <div class="s2h-timeline__date">Hier - 15:22</div>
                                    <div class="s2h-timeline__title">Contribution acceptée</div>
                                    <div class="s2h-timeline__description">Votre proposition d'amélioration pour le test "Évaluation de la mémoire de travail" a été intégrée.</div>
                                </div>
                            </div>
                            
                            <!-- Événement 3 -->
                            <div class="s2h-timeline__event s2h-timeline--warning">
                                <div class="s2h-timeline__dot"></div>
                                <div class="s2h-timeline__content">
                                    <div class="s2h-timeline__date">10 mars 2025 - 09:15</div>
                                    <div class="s2h-timeline__title">Mise à jour requise</div>
                                    <div class="s2h-timeline__description">Des modifications sont nécessaires pour le test "Analyse du discours spontané" suite aux retours du comité éthique.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Intégration du Footer -->
    <footer class="s2h-footer">
      <div class="s2h-container s2h-footer__content">
        <div class="s2h-footer__section">
          <h4 class="s2h-footer__title">À propos</h4>
          <ul class="s2h-footer__links">
            <li class="s2h-footer__link-item"><a href="/pages/a-propos/qui-sommes-nous.html" class="s2h-footer__link">Qui sommes-nous ?</a></li>
            <li class="s2h-footer__link-item"><a href="/pages/a-propos/notre-mission.html" class="s2h-footer__link">Notre mission</a></li>
            <li class="s2h-footer__link-item"><a href="/pages/a-propos/carrieres.html" class="s2h-footer__link">Carrières</a></li>
          </ul>
        </div>
        <div class="s2h-footer__section">
          <h4 class="s2h-footer__title">Support</h4>
          <ul class="s2h-footer__links">
            <li class="s2h-footer__link-item"><a href="/pages/support/faq.html" class="s2h-footer__link">FAQ</a></li>
            <li class="s2h-footer__link-item"><a href="/pages/support/contact.html" class="s2h-footer__link">Contact</a></li>
            <li class="s2h-footer__link-item"><a href="/pages/communaute/forum.html" class="s2h-footer__link">Forum</a></li>
          </ul>
        </div>
        <div class="s2h-footer__section">
          <h4 class="s2h-footer__title">Légal</h4>
          <ul class="s2h-footer__links">
            <li class="s2h-footer__link-item"><a href="/pages/legal/mentions-legales.html" class="s2h-footer__link">Mentions légales</a></li>
            <li class="s2h-footer__link-item"><a href="/pages/legal/politique-confidentialite.html" class="s2h-footer__link">Politique de confidentialité</a></li>
            <li class="s2h-footer__link-item"><a href="/pages/legal/conditions-utilisation.html" class="s2h-footer__link">Conditions d'utilisation</a></li>
          </ul>
        </div>
      </div>
      <div class="s2h-container">
        <div class="s2h-footer__copyright">
          &copy; 2025 Speech2Health. Tous droits réservés.
        </div>
      </div>
    </footer>

    <!-- Style supplémentaire pour la navigation du compte -->
    <style>
        .s2h-account-nav__list {
            list-style: none;
        }
        
        .s2h-account-nav__item {
            margin-bottom: var(--s2h-spacing-xs);
        }
        
        .s2h-account-nav__link {
            display: block;
            padding: var(--s2h-spacing-sm) var(--s2h-spacing);
            border-radius: var(--s2h-radius);
            transition: var(--s2h-transition);
            color: var(--s2h-text-dark);
        }
        
        .s2h-account-nav__link:hover {
            background-color: rgba(74, 144, 226, 0.05);
            color: var(--s2h-primary);
        }
        
        .s2h-account-nav__item--active .s2h-account-nav__link {
            background-color: rgba(74, 144, 226, 0.1);
            color: var(--s2h-primary);
            font-weight: 500;
        }
        
        .s2h-mr-sm {
            margin-right: var(--s2h-spacing-sm);
        }
    </style>

    <!-- Script pour l'intégration de VAPI (CORRIGÉ) -->
    <script>
        var vapiInstance = null;
        var vapiInitialized = false;
        var vapiLoading = false;
        
        document.addEventListener('DOMContentLoaded', function() {
            const statusElement = document.getElementById('vapi-status');
            
            // Afficher le statut initial
            statusElement.textContent = "Initialisation de l'assistant vocal...";
            statusElement.style.display = "block";
            
            // Bouton personnalisé pour activer VAPI
            const vapiButton = document.getElementById('vapi-trigger-custom');
            
            if (!vapiButton) {
                console.error("Bouton VAPI non trouvé dans le DOM");
                return;
            }
            
            vapiButton.addEventListener('click', function() {
                console.log("Bouton VAPI cliqué");
                
                if (vapiInstance && vapiInitialized) {
                    console.log("Ouverture de l'instance VAPI");
                    vapiInstance.open();
                } else if (vapiLoading) {
                    statusElement.textContent = "L'assistant vocal est en cours de chargement. Veuillez patienter...";
                    statusElement.style.display = "block";
                } else {
                    console.log("Initialisation de VAPI");
                    statusElement.textContent = "Initialisation de l'assistant vocal...";
                    statusElement.style.display = "block";
                    initVapi();
                }
            });
            
            // Initialisation automatique au chargement de la page
            initVapi();
        });
        
        function initVapi() {
            if (vapiLoading) return;
            vapiLoading = true;
            
            const statusElement = document.getElementById('vapi-status');
            console.log("Début du chargement de VAPI");
            
            // Configuration de VAPI
            const assistant = "8558a039-8d04-481b-a777-d41e2d446748";
            const apiKey = "7fba6bce-4ea8-42a0-a0d1-33c7ef73262f";
            
            // Configuration du bouton personnalisé
            const buttonConfig = {
                position: "bottom-right",
                size: "large",
                color: "#4A90E2",
                text: "Assistant vocal",
                textColor: "#FFFFFF",
                // Désactivez le bouton natif puisque nous utilisons notre propre bouton
                visible: false
            };
            
            try {
                // Vérifiez si le SDK est déjà chargé
                if (window.vapiSDK) {
                    console.log("SDK VAPI déjà chargé, initialisation de l'instance");
                    vapiInstance = window.vapiSDK.run({
                        apiKey: apiKey,
                        assistant: assistant,
                        config: buttonConfig,
                        onInitialized: function() {
                            vapiInitialized = true;
                            vapiLoading = false;
                            statusElement.textContent = "Assistant vocal prêt ! Cliquez sur le bouton pour commencer.";
                            console.log("Instance VAPI initialisée avec succès");
                        }
                    });
                } else {
                    console.log("Chargement du SDK VAPI");
                    // Intégration du script VAPI
                    var script = document.createElement('script');
                    script.src = "https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@latest/dist/assets/index.js";
                    script.defer = true;
                    script.async = true;
                    
                    script.onload = function() {
                        console.log("SDK VAPI chargé avec succès");
                        if (window.vapiSDK) {
                            vapiInstance = window.vapiSDK.run({
                                apiKey: apiKey,
                                assistant: assistant,
                                config: buttonConfig,
                                onInitialized: function() {
                                    vapiInitialized = true;
                                    vapiLoading = false;
                                    statusElement.textContent = "Assistant vocal prêt ! Cliquez sur le bouton pour commencer.";
                                    console.log("Instance VAPI initialisée avec succès");
                                }
                            });
                        } else {
                            console.error("window.vapiSDK non disponible après chargement du script");
                            vapiLoading = false;
                            statusElement.textContent = "Erreur de chargement de l'assistant vocal. Veuillez rafraîchir la page.";
                        }
                    };
                    
                    script.onerror = function() {
                        console.error("Erreur lors du chargement du SDK VAPI");
                        vapiLoading = false;
                        statusElement.textContent = "Impossible de charger l'assistant vocal. Veuillez vérifier votre connexion internet.";
                    };
                    
                    document.head.appendChild(script);
                }
            } catch (error) {
                console.error("Erreur lors de l'initialisation de VAPI:", error);
                vapiLoading = false;
                statusElement.textContent = "Une erreur s'est produite. Veuillez rafraîchir la page et réessayer.";
            }
        }
    </script>
    
    <!-- Script pour la gestion active de la navigation -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.s2h-nav__link');
            
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                // Ajoute la classe active si l'URL courante correspond au lien
                if (currentPath.includes(href) && href !== '/') {
                    link.classList.add('s2h-nav__link--active');
                } else if (currentPath === '/' && href === '/') {
                    link.classList.add('s2h-nav__link--active');
                }
            });
        });
    </script>
</body>
</html>